The aim of eASTROGAM_Analysis_file_remote code is to analyze the fits files created by BoGEMMSâ€™ simulations. Entered the initial parameters, the code reads the fits files and saves the events which have interacted with the tracker, i.e. the ones with deposited energy greater than zero. The same method is made for the calorimeter and for the anti-coincidence. 

Are there some triggers?

First step: from hit to plan and strip ID and energy deposit for each strip.

For each view, the first step is to convert the tracker volume id into strip id and tray id (which starts from bottom), and then the tray id is converted into plane id (which starts from top). After that the G4.RAW.eASTROGAM.fits file is generated; it contains all the informations of the particles that interacts with the tracker at level of hits, i.e. event id, volume id, mother id, tray id, plane id, strip id (x and y), energy deposited, entry and exit coordinates of the particles, child id, process id. 

If the strips are not active, the AA.FAKE.eASTROGAM.dat file is created and it contains the event id, theta and phi and energy input, plane id, z position, x/y flag (x = 0, y = 1), x and y position, deposited energy (keV), number of strips of the cluster (in this case 1), child id, proc id.
At this point, in order to pass from hits to strips, the code gets the two fits files generated by eASTROGAM_geometry. First of all, for every event, we consider the energy stored in every strip and then we divide the compton processes from the pair production ones, regarding the interaction of the primary particle. After (WHAT?) we are going to sum the energy along the strip (because strip works like an integrator) and to apply the energy threshold.
Then the code generates two files: 
L0.eASTROGAM.fits: in this file the energy is summed with energy threshold applied and the events are sorted in tray (Y before X within the same tray);
strip.dat (for AA input): in this file there are information at the level of the strips (x and y view), i.e. event id, theta and phi and energy input, plane id, z position, x/y flag (x = 0, y = 1), strip id, strip position (reference system center at the silicon layer center), deposited energy (keV), pair flag (1 = pair, 2 = compton, 0 = none of both)

Cluster-ID

The next step is the determination of the cluster and its barycenter in order to extract the information at the cluster level because this method allows to obtain better results. This algorithm considers the most probable interaction position which is given by the weighted average between the strips position and their deposited energy.	
In the final outputs the energy is summed, the energy threshold is applied and the strip position is used. These are:
L0.5.eASTROGAM.fits, that contains: event id, tray id, plane id, si id, position, z position, deposited energy, pair flag;
cluster.dat, that contains: event id, theta and phi and energy input, plane id, z position, x/y flag (x = 0, y = 1), cluster position (reference system center at the silicon layer center), deposited energy (keV), number of strips composing the cluster, pair flag (1 = pair, 2 = compton, 0 = none of both);
cluster_pair.dat, in which we consider only the pair production events of the cluster.dat file;
cluster_compton.dat, in which we consider only the compton events of the cluster.dat file.

Calorimeter

The second step is the processing of the calorimeter, in which we sum the energy stored in bars (for every event) and where we apply the energy threshold. 
The final outputs are:
G4.CAL.eASTROGAM.fits, that contains the event id, the bar id and the bar energy;
SUM.CAL.eASTROGAM.fits, in which we sum the bar energy for every equal event id. It contains event id and bar


Anticoincidence

At the end,  AC system is processed. For every panel, the deposited energy (for each event) is summed.
The ouput is:
G4.AC.eASTROGAM.fits, that coontains the event id, AC panels, AC subpanels and the deposited energy.

